apiVersion: platform.integratn.tech/v1alpha1
kind: VCluster
metadata:
  name: dev-test
  namespace: platform-requests
  annotations:
    platform.integratn.tech/reconcile-at: "2026-01-17T20:30:00Z"
spec:
  name: dev-test
  targetNamespace: vcluster-dev-test
  preset: dev
  coredns:
    replicas: 1
  k8sVersion: "v1.34.3"
  hostname: dev-test.integratn.tech
  subnet: 10.0.6.0/24
  apiPort: 443
  helmOverrides:
    experimental:
      deploy:
        vcluster:
          manifests: |
            apiVersion: v1
            kind: ConfigMap
            metadata:
              name: coredns
              namespace: kube-system
            data:
              Corefile: |-
                .:1053 {
                    errors
                    health
                    ready
                    rewrite name regex .*\.nodes\.vcluster\.com kubernetes.default.svc.cluster.local
                    kubernetes cluster.local in-addr.arpa ip6.arpa {
                        pods insecure
                        fallthrough in-addr.arpa ip6.arpa
                    }
                    hosts /etc/coredns/NodeHosts {
                        ttl 60
                        reload 15s
                        fallthrough
                    }
                    prometheus :9153
                    forward . /etc/resolv.conf
                    cache 30
                    loop
                    reload
                    loadbalance
                }

                import /etc/coredns/custom/*.server
              NodeHosts: ""