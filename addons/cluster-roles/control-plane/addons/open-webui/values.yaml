# Open WebUI Helm values (chart v12.5.0) — external Ollama, Pipelines enabled
ollama:
  enabled: false

ollamaUrls:
  - "http://10.0.3.4:11434"

pipelines:
  enabled: true
  extraEnvVars: []

image:
  tag: ""  # Use chart default

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    memory: 1Gi

persistence:
  enabled: true
  size: 2Gi
  storageClass: config-nfs-client
  accessModes:
    - ReadWriteOnce

ingress:
  enabled: false

# Native Gateway API HTTPRoute (new in chart v12+)
route:
  enabled: true
  apiVersion: gateway.networking.k8s.io/v1
  kind: HTTPRoute
  hostnames:
    - "chat.cluster.integratn.tech"
  parentRefs:
    - name: nginx-gateway
      namespace: nginx-gateway
      sectionName: https
  httpsRedirect: false

# Disable websocket redis (single replica, not needed)
websocket:
  enabled: false

extraEnvVars:
  - name: WEBUI_SECRET_KEY
    valueFrom:
      secretKeyRef:
        name: open-webui-secrets
        key: secret-key
  # OIDC / Authentik SSO
  - name: ENABLE_OAUTH_SIGNUP
    value: "true"
  - name: OAUTH_PROVIDER_NAME
    value: "Authentik"
  - name: OPENID_PROVIDER_URL
    value: "https://auth.cluster.integratn.tech/application/o/open-webui/.well-known/openid-configuration"
  - name: OAUTH_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: open-webui-secrets
        key: oidc-client-id
  - name: OAUTH_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: open-webui-secrets
        key: oidc-client-secret
  - name: OAUTH_SCOPES
    value: "openid email profile groups"
  - name: ENABLE_OAUTH_ROLE_MANAGEMENT
    value: "true"
  - name: OAUTH_ADMIN_ROLES
    value: "authentik Admins"
  - name: OAUTH_ALLOWED_ROLES
    value: "authentik Admins,open-webui-users"
  # Disable local signup — SSO only
  - name: ENABLE_SIGNUP
    value: "false"
  - name: ENABLE_LOGIN_FORM
    value: "true"
  - name: DEFAULT_USER_ROLE
    value: "user"
  # RAG settings
  - name: ENABLE_RAG_WEB_SEARCH
    value: "false"
  - name: RAG_EMBEDDING_ENGINE
    value: "ollama"
  - name: RAG_EMBEDDING_MODEL
    value: "nomic-embed-text"
  - name: RAG_OPENAI_API_BASE_URL
    value: "http://10.0.3.4:11434"
