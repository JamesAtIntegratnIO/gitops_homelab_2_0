kratix:
  enabled: true
  namespace: kratix-platform-system
  chartName: kratix
  project: platform
  chartRepository: https://syntasso.github.io/helm-charts
  defaultVersion: "0.0.1"
  selector:
    matchExpressions:
      - key: enable_kratix
        operator: In
        values: ['true']
  syncPolicy:
    automated:
      selfHeal: true
      allowEmpty: true
      prune: true

kratix-promises:
  enabled: true
  type: manifest
  namespace: default
  project: platform
  defaultVersion: "main"
  selector:
    matchExpressions:
      - key: enable_kratix
        operator: In
        values: ['true']
  manifestSource:
    repoURL: https://github.com/jamesatintegratnio/gitops_homelab_2_0.git
    targetRevision: main
    path: promises
    directory:
      recurse: true
      exclude: vcluster/pipelines/vcluster.values.schema.json,_archived/**,vcluster-orchestrator-v2/workflows/**,**/templates/**
  syncPolicy:
    automated:
      selfHeal: true
      prune: true
    syncOptions:
      - CreateNamespace=false
  info:
    - name: Description
      value: Automatically installs all Kratix Promises from the promises/ directory

platform-vclusters:
  enabled: true
  type: manifest
  namespace: platform-requests
  project: platform
  defaultVersion: "main"
  selector:
    matchExpressions:
      - key: enable_kratix
        operator: In
        values: ['true']
  manifestSource:
    repoURL: https://github.com/jamesatintegratnio/gitops_homelab_2_0.git
    targetRevision: main
    path: platform/vclusters
    directory:
      recurse: true
  syncPolicy:
    automated:
      selfHeal: true
      prune: true
    syncOptions:
      - CreateNamespace=true
  info:
    - name: Description
      value: Kratix ResourceRequests for vCluster provisioning

observability-secrets:
  enabled: true
  type: manifest
  namespace: monitoring
  project: platform-services
  defaultVersion: "main"
  path: addons/cluster-roles/control-plane/addons/observability-secrets
  selector:
    matchExpressions:
      - key: cluster_role
        operator: NotIn
        values: ['vcluster']
  syncPolicy:
    automated:
      selfHeal: true
      prune: true
    syncOptions:
      - CreateNamespace=true

kube-prometheus-stack:
  enabled: true
  namespace: monitoring
  releaseName: kube-prometheus-stack
  chartName: kube-prometheus-stack
  project: platform-services
  chartRepository: https://prometheus-community.github.io/helm-charts
  defaultVersion: "58.2.1"
  selector:
    matchExpressions:
      - key: cluster_role
        operator: NotIn
        values: ['vcluster']
  syncPolicy:
    automated: {}
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true

loki:
  enabled: true
  namespace: loki
  releaseName: loki
  chartName: loki
  project: platform-services
  chartRepository: https://grafana.github.io/helm-charts
  defaultVersion: "6.49.0"
  selector:
    matchExpressions:
      - key: cluster_role
        operator: NotIn
        values: ['vcluster']
  annotations:
    argocd.argoproj.io/compare-options: ServerSideDiff=true
  ignoreDifferences:
    - group: apps
      kind: StatefulSet
      jsonPointers:
        - /spec/volumeClaimTemplates/0/metadata/creationTimestamp
        - /spec/volumeClaimTemplates/0/status
  syncPolicy:
    automated: {}
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true

promtail:
  enabled: true
  namespace: promtail
  releaseName: promtail
  chartName: promtail
  project: platform-services
  chartRepository: https://grafana.github.io/helm-charts
  defaultVersion: "6.9.0"
  selector:
    matchExpressions:
      - key: cluster_role
        operator: NotIn
        values: ['vcluster']
  syncPolicy:
    automated: {}
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
